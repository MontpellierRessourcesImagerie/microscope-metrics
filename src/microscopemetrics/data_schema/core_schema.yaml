id: https://github.com/MontpellierRessourcesImagerie/microscope-metrics/blob/main/src/microscopemetrics/data_schema/core_schema.yaml
name: microscopemetrics_core_schema
prefixes:
#  metrics: https://github.com/MontpellierRessourcesImagerie/microscope-metrics/blob/main/src/microscopemetrics/model/
#imports:
#  - metrics:types
  linkml: https://w3id.org/linkml/
imports:
  - linkml:types

default_range: string


classes:
  MetaObject:
    class_uri: linkml:Any

  NamedObject:
    description: An object with a name and a description
    abstract: true
    slots:
      - name
      - description

  MetricsObject:
    is_a: NamedObject
    abstract: true
    description: A base object for all microscope-metrics objects

  Sample:
    is_a: NamedObject
    description: A sample is a standard physical object that is imaged by a microscope
    attributes:
      type:   # TODO: develop the sample class
        range: string
        required: true
        identifier: true
      protocol:
        range: Protocol
        required: true
        multivalued: false

  Protocol:
    is_a: NamedObject
    description: Set of instructions for preparing and imaging a sample
    attributes:
      version:
        required: true
      authors:
        range: Experimenter
        multivalued: true
        inlined: false
      url:
        required: true

  Experimenter:
    description: The person that performed the experiment or developed the protocol
    attributes:
      name:
        range: string
        description: The name of the experimenter
        required: true
      orcid:
        range: string
        description: The ORCID of the experimenter
        recommended: true
        identifier: true

  MetricsDataset:
    is_a: NamedObject
    description: A base object on which microscope-metrics runs the analysis
    tree_root: true
    attributes:
      sample:
        range: Sample
        multivalued: false
        inlined: false
      experimenter:
        range: Experimenter
        multivalued: true
      acquisition_date:
        range: date
        multivalued: false
      processed:
        range: boolean
        multivalued: false
        required: true
        ifabsent: false
      processing_date:
        range: date
        multivalued: false
      processing_log:
        range: string
        multivalued: false
      inputs:
        range: string
        description: A list of the slots used as input for the analysis
        multivalued: true
      outputs:
        range: string
        description: A list of the slots generated by the analysis
        multivalued: true

  Image:
    is_a: MetricsObject
    description: A base object for all microscope-metrics images
    abstract: true
    slots:
      - uri

  ImageAsNumpy:
    is_a: Image
    description: An image as a numpy array in TZYXC order
    attributes:
      data:
        range: MetaObject

  ImageInline:
    is_a: Image
    description: A base object for all microscope-metrics images that are stored as arrays in line
    abstract: true
    attributes:
      data:
        implements:
          - linkml:elements
        range: float
        multivalued: true
        required: true

  ImageMask:
    is_a: ImageInline
    description: A base object for all microscope-metrics masks
    attributes:
      x_position:
        range: float
        ifabsent: float(0.0)
      y_position:
        range: float
        ifabsent: float(0.0)
      x:
        range: PixelSeries
        implements:
          - linkml:axis0
        required: true
      y:
        range: PixelSeries
        implements:
          - linkml:axis1
        required: true
      data:
        implements:
          - linkml:elements
        range: boolean
        multivalued: true
        required: true

  Image2D:
    is_a: ImageInline
    description: A 2D image in YX order
    implements:
      - linkml:TwoDimensionalArray
      - linkml:RowOrderedArray
    attributes:
      y:
        range: PixelSeries
        implements:
          - linkml:axis0
        required: true
      x:
        range: PixelSeries
        implements:
          - linkml:axis1
        required: true

  Image5D:
    is_a: ImageInline
    description: A 5D image in TZYXC order
    implements:
      - linkml:FiveDimensionalArray
      - linkml:RowOrderedArray
    attributes:
      t:
        range: TimeSeries
        implements:
          - linkml:axis0
        required: true
      z:
        range: PixelSeries
        implements:
          - linkml:axis1
        required: true
      y:
        range: PixelSeries
        implements:
          - linkml:axis2
        required: true
      x:
        range: PixelSeries
        implements:
          - linkml:axis3
        required: true
      c:
        range: ChannelSeries
        implements:
          - linkml:axis4
        required: true

  PixelSeries:
    description: >-
      A series whose values represent pixels or voxels or a single integer defining the shape of the dimension
    implements:
      - linkml:OneDimensionalSeries
    attributes:
      values:
        range: integer
        multivalued: true
        implements:
          - linkml:elements
        required: true

  ChannelSeries:
    description: A series whose values represent channel
    implements:
      - linkml:OneDimensionalSeries
    attributes:
      values:
        range: integer
        multivalued: true
        implements:
          - linkml:elements
        required: true

  TimeSeries:
    description: A series whose values represent time
    implements:
      - linkml:OneDimensionalSeries
    attributes:
      values:
        range: float
        multivalued: true
        implements:
          - linkml:elements
        required: true
        unit:
          ucum_code: s

  ROI:
    description: A ROI. Collection of shapes and an image to which they are applied
    attributes:
      image:
        range: Image
        required: true
        multivalued: true
        inlined: false
      shapes:
        range: Shape
        multivalued: true

  Shape:
    description: A shape
    abstract: true
    attributes:
      z:
        range: float
      c:
        range: integer
      t:
        range: integer
      fill_color:
        range: Color
      stroke_color:
        range: Color
      stroke_width:
        range: integer

  Point:
    is_a: Shape
    description: A point as defined by x and y coordinates
    attributes:
      x:
        range: float
        multivalued: false
      y:
        range: float
        multivalued: false

  Line:
    is_a: Shape
    description: A line as defined by x1, y1, x2, y2 coordinates
    attributes:
      x1:
        range: float
        multivalued: false
      y1:
        range: float
        multivalued: false
      x2:
        range: float
        multivalued: false
      x3:
        range: float
        multivalued: false

  Rectangle:
    is_a: Shape
    description: A rectangle as defined by x, y coordinates and width, height
    attributes:
      x:
        range: float
        multivalued: false
      y:
        range: float
        multivalued: false
      w:
        range: float
        multivalued: false
      h:
        range: float
        multivalued: false

  Ellipse:
    is_a: Shape
    description: An ellipse as defined by x, y coordinates and x and y radii
    attributes:
      x:
        range: float
        multivalued: false
      y:
        range: float
        multivalued: false
      x_rad:
        range: float
        multivalued: false
      y_rad:
        range: float
        multivalued: false

  Polygon:
    is_a: Shape
    description: >-
      A polygon as defined by a series of vertexes and a boolean to indicate if closed or not
    attributes:
      vertexes:
        range: Vertex
        multivalued: true
        required: true
      is_open:
        range: boolean
        multivalued: false
        ifabsent: False

  Vertex:
    description: A vertex as defined by x and y coordinates
    attributes:
      x:
        range: float
        multivalued: false
        required: true
      y:
        range: float
        multivalued: false
        required: true

  Mask: # review for arrays
    is_a: Shape
    description: A mask as defined by a boolean image
    attributes:
      mask:
        range: ImageMask
        multivalued: false

  Color:
    description: A color as defined by RGB values and an optional alpha value
    attributes:
      R:
        range: integer
        required: true
        multivalued: false
        minimum_value: 0
        maximum_value: 255
      G:
        range: integer
        required: true
        multivalued: false
        minimum_value: 0
        maximum_value: 255
      B:
        range: integer
        required: true
        multivalued: false
        minimum_value: 0
        maximum_value: 255
      alpha:
        range: integer
        required: false
        multivalued: false
        minimum_value: 0
        maximum_value: 255

  KeyValues:
    description: A collection of key-value pairs
    attributes:
      key_values:
        range: KeyValuePair
        required: true
        multivalued: true
        inlined: true
        inlined_as_list: false

  KeyValuePair:
    description: A key-value pair
    attributes:
      name:
        range: string
        key: true
      value:
        range: string

  Tag:
    description: A tag
    attributes:
      id:
        range: integer
        identifier: true
        required: true
        multivalued: false
      text:
        range: string
        required: true
        multivalued: false
      description:
        range: string
        required: false
        multivalued: false

  Comment:
    description: A comment
    attributes:
      text:
        range: string
        required: true
        multivalued: false

  Table:
    is_a: MetricsObject
    description: A table
    abstract: true

  TableAsPandasDF:
    is_a: Table
    description: A table as a Pandas DataFrame
    attributes:
      df:
        range: MetaObject
        required: true
        multivalued: false

  TableInlined:
    is_a: Table
    description: A table inlined in a metrics dataset
    attributes:
      columns:
          range: Column
          required: true
          multivalued: true

  Column:
    description: A column
    attributes:
      name:
        range: string
        required: true
        multivalued: false
      values:
        range: string
        required: true
        multivalued: true


slots:
  uri:
    range: uri
    description: An URI
    multivalued: false
  id:
    range: string
    description: The unique identifier for an entity
    identifier: true
    required: true
    multivalued: false
  name:
    range: string
    description: The name of an entity
    required: false
    multivalued: false
  description:
    range: string
    description: A description of an entity
    multivalued: false


enums:
